<script>
document.addEventListener('DOMContentLoaded', () => {
  // --- Lenyitható dobozok ---
  document.querySelectorAll('.toggle-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const parent = btn.closest('.detail-item');
      parent.classList.toggle('open');
      const label = btn.querySelector('.label');
      const arrow = btn.querySelector('.arrow');
      if (parent.classList.contains('open')) {
        if (label) label.textContent = 'Bezárás';
        if (arrow) arrow.textContent = '▲';
      } else {
        if (label) label.textContent = 'Részletek';
        if (arrow) arrow.textContent = '▼';
      }
    });
  });

  // --- Hamburger + overlay ---
  const hamburger = document.getElementById('hamburger');
  const navLinks  = document.getElementById('nav-links');
  const overlay   = document.getElementById('mobile-overlay');

  if (!hamburger || !navLinks || !overlay) return;

  const openMenu = () => {
    navLinks.classList.add('active');
    hamburger.classList.add('active');
    overlay.classList.add('active');
    hamburger.setAttribute('aria-expanded', 'true');
  };
  const closeMenu = () => {
    navLinks.classList.remove('active');
    hamburger.classList.remove('active');
    overlay.classList.remove('active');
    hamburger.setAttribute('aria-expanded', 'false');
  };
  const isMenuOpen = () => navLinks.classList.contains('active');

  // Nyit/zár gombbal
  hamburger.addEventListener('click', (e) => {
    e.stopPropagation();
    isMenuOpen() ? closeMenu() : openMenu();
  });

  // Linkre kattintás: HAGYJUK a natív anchor-görgetést, csak zárjuk
  navLinks.querySelectorAll('a[href^="#"]').forEach(link => {
    link.addEventListener('click', () => closeMenu());
  });

  // Overlay-re kattintás -> zárás
  overlay.addEventListener('click', closeMenu);

  // Menün kívüli kattintás -> zárás (biztonsági)
  document.addEventListener('click', (e) => {
    if (!isMenuOpen()) return;
    const clickedInside = navLinks.contains(e.target) || hamburger.contains(e.target);
    if (!clickedInside) closeMenu();
  });

  // ESC -> zárás
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && isMenuOpen()) closeMenu();
  });

  // Átméretezés/orientációváltás -> zárás
  window.addEventListener('resize', closeMenu);
  window.addEventListener('orientationchange', closeMenu);

  // Betöltéskor minden detail-item zárva
  document.querySelectorAll(".detail-item").forEach(item => {
    item.classList.remove("open");
    const lbl = item.querySelector(".toggle-btn .label");
    const arr = item.querySelector(".toggle-btn .arrow");
    if (lbl) lbl.textContent = "Részletek";
    if (arr) arr.textContent = "▼";
  });
});
</script>
